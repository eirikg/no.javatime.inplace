<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:22.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:15.0pt;
	margin-left:0cm;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:15.0pt;
	margin-left:0cm;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:36.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;
	font-style:italic;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0cm 0cm 4.0pt 0cm'>

<p class=MsoTitle><a name="_Toc312283492">Dynamic Workspace Bundles</a></p>

</div>

<p class=MsoTocHeading>Contents</p>

<p class=MsoToc1><a href="#_Toc349215661">A Dynamic Workspace for Plug-ins and
Bundles<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc349215662">How Workspace bundles are updated<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc349215663">Target and development platform<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc349215664">Bundle Versions<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc349215665">Bundle Dependencies<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc349215666">Activate Providing Bundles<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc349215667">Deactivate Requiring Bundles<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc349215668">Update Bundles<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc349215669">Dependency Rules<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc1><a href="#_Toc349215670">Bundle States and Transitions<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc349215671">Introduction<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc349215672">Transitions and Bundle Operations<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc3><a href="#_Toc349215673">Bundle Project<span style='color:
windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc3><a href="#_Toc349215674">Workspace and Composite Commands<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoToc3><a href="#_Toc349215675">Project CRUD Operations<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc3><a href="#_Toc349215676">Implicit and Explicit Commands<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc349215677">The Bundle State Diagram<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<h1><a name="_Toc349215661">A Dynamic Workspace for Plug-ins and Bundles</a></h1>

<p class=MsoNormal>A workspace plug-in project or bundle project is installed
and started from an originating plug-in source project after Eclipse has been started.
The term bundle project (or workspace bundle) is used when referring to both
the project and the bundle at the same time as one coherent unit. A deployed
plug-in originates from a jar bundle and is typically installed and started during
startup of Eclipse. Both workspace and deployed plug-ins are dynamic in the
sense that they may change state after they are installed. Workspace bundles
dynamically change its runtime behavior when source projects are updated or
changed during an Eclipse session. Deployed bundles require a manual
re-installation or an installation of a new version to change its runtime
behavior.</p>

<p class=MsoNormal>A workspace bundle can be dependent on and require
capabilities from deployed bundles, but a deployed bundle, with a few
exceptions, cannot require capabilities from a workspace bundle. The exceptions
include call backs from deployed bundles to workspace bundles at runtime and
workspace fragment bundles attached to a deployed bundle. From this follows that
deployed bundles provide capabilities to workspace bundles and a workspace
bundle does not provide capabilities to deployed bundles during an Eclipse
session.</p>

<p class=MsoNormal>Workspace bundle projects can be viewed as a set of plug-ins
in a workspace region disjoint from the set of deployed plug-ins providing
capabilities to the workspace plug-ins.  A workspace bundle first becomes a jar
bundle when it is deployed.</p>

<h1><a name="_Toc349215662">How Workspace bundles are updated</a></h1>

<p class=MsoNormal>It is not possible to update jar bundles dynamically within
an Eclipse session as opposed to workspace bundles. For workspace bundles the
build system in combination with the dynamics of OSGi is utilized is to resolve
and start (execute) plug-ins automatically after they have been built. </p>

<p class=MsoNormal>The tight loop between source code changes and execution is
especially efficient when doing <span lang=EN>Rapid Application Development</span><span
lang=EN> (RAD) </span>testing small incremental changes in plug-ins.  The
functionality is in general useful for any tool or project (e.g. design tools
or code generators) in need for a runtime environment embedded in the
development workspace.</p>

<h1><a name="_Toc349215663">Target and development platform</a></h1>

<p class=MsoNormal>Traditionally to activate and execute workspace plug-ins projects
in Eclipse the Run command is used to launch a new instance of the Eclipse IDE,
called the target platform. By default this activates all jar bundles defined
in the runtime configuration of the target together with the plug-in projects in
the workspace </p>

<p class=MsoNormal>The target platform is known as the execution or runtime
environment for the plug-ins under development. The source or development
platform is where the bundles are developed and built. The InPlace Activator
treats the target and development platform the same and thus the same instance
of the IDE (workbench) is used both for the target and development platform. </p>

<h1><a name="_Toc349215664">Bundle Versions</a></h1>

<p class=MsoNormal>Versions become important when bundles are packed in jars, deployed,
installed and resolved by an external OSGi container. In a deployed scenario
different versions of a bundle may run at the same time where each version usually
only has one revision. In the same manner different versions of workspace
bundles with the same symbolic name, but different location identifiers, may
run simultaneously. This may be the case if you copy a project to a different
location, changes the version and then activates the bundle.</p>

<h1><a name=BuindleDependencies></a><a name="_Toc349215665">Bundle Dependencies</a></h1>

<p class=MsoNormal>A new revision is assigned to a bundle each time it is
installed and updated and removed when the bundle is uninstalled. Old revisions
are removed when a bundle is refreshed.</p>

<p class=MsoNormal>A requiring bundle dependency implies that a bundle directly
or indirectly requires some capabilities provided by another bundle (called the
requiring dependency closure). </p>

<p class=MsoNormal>For example, an Export-Package clause is a capability and an
Import-Package clause is a requirement. During the resolving phase the requirements
are resolved to matching capabilities by creating a Bundle Wire. A wiring is created
each time a bundle revision is resolved, holding the wires to other bundle wirings
as well as maintaining the run time state of the bundle</p>

<p class=MsoNormal>If the contract between two bundles is broken because
exported packages are withdrawn or the API of interfaces in exported packages
is broken this will result in compile time errors and the involved bundles will
not resolve. In this case, if any, the current revision and wiring is used. </p>

<p class=MsoNormal>When installing, updating and executing bundles directly
from compiled source files, the last resolve holds the current revision and its
wires of the bundle. Every time a bundle is updated after a change, a new
revision called the current revision of the bundle is created and when resolved
new wires are bound to that revision. Earlier revision(s) and the wires of the bundle
are released during the update process when bundle is refreshed after an update. 
</p>

<p class=MsoNormal> A workspace bundle may have many revisions at the same
time. Other bundles may require capabilities or services from different
revisions of a bundle. A bundle changes from the usage of an older revision to
a newer revision of a bundle if possible when the bundle is refreshed.  Bundles
may be refreshed manually from the UI and are always refreshed automatically
when deactivated (unresolved or uninstalled) and after update if the<a
href="../tasks/Setting%20Bundle%20Options.htm#RefreshOnUpdate"> Refresh on
Update</a> option is switched on (default). </p>

<h2><a name="_Toc349215666"></a><a name="_Toc335581793">Activate Providing
Bundles</a></h2>

<p class=MsoNormal>If bundle A is dependent on bundle B, and bundle A is
activated, bundle B has to be activated to.  If you activate a providing
bundle, as in this case bundle B, this does not imply activation of the
requiring bundle (bundle A). </p>

<h2><a name="_Toc349215667"></a><a name="_Toc335581794">Deactivate Requiring
Bundles</a></h2>

<p class=MsoNormal>When deactivating bundles the rule is reversed. That is,
deactivating a providing bundle (bundle B) the requiring bundle is also
deactivated (bundle A), but when deactivating a requiring bundle (bundle A),
bundle B is unchanged. </p>

<h2><a name="_Toc349215668">Update Bundles</a></h2>

<p class=MsoNormal>When a bundle is updated, the bundle and all requiring
bundles are stopped in correct dependency order. Then the bundle is updated and
refreshed if the <a
href="../tasks/Setting%20Bundle%20Options.htm#RefreshOnUpdate">Refresh on
Update</a> option is switched on.  The refresh operation releases any existing
wires and new wires are created. When the option is off the bundle is resolved
after update instead of refreshed.  Lastly all providing bundles are started in
correct dependency order. </p>

<h2><a name="_Toc349215669"></a><a name="_Toc335581795">Dependency Rules</a></h2>

<p class=MsoNormal>The activation/deactivation is in principle controlled by
three basic dependency rules:</p>

<p class=MsoListParagraphCxSpFirst style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Directed</b><br>
Dependencies between bundles goes only in one direction; - From a requiring
bundle to a providing bundle.  The requiring (dependent) bundle is dependent on
the providing (independent) bundle.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Acyclic</b> <br>
States that a dependency relationship cannot be circular. If bundle A requires
capabilities from a providing bundle B, bundle A is said to be dependent on B.
Thus bundle B cannot at the same time be dependent on bundle A.  This is also
true for transitive dependencies, as stated in the next bullet.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Transitive</b><br>
Dependency relationships spans across bundles. If bundle A is dependent on
bundle B and bundle B is dependent on bundle C, bundle A is also dependent on
bundle C.</p>

<p class=MsoNormal>When a bundle is activated or deactivated the direction of
the dependency and the acyclic and transitive properties of the relationships
between bundles controls which additional bundles are activated or deactivated.
</p>

<p class=MsoNormal>By design the InPlace Activator automatically enforce
changes in life cycle of bundles that have relationships to other bundles that
have their life cycle changed. For instance when a bundle that requires
capabilities form another bundle is activated the providing bundle is also
activated.      </p>

<p class=MsoNormal>When an Eclipse session ends all bundles are uninstalled
before Eclipse shut down. When starting a new session, activated bundles from
earlier sessions are by default started but bundles in state RESOLVED at shutdown
return to state RESOLVED at next startup.</p>

<h1><a name=BundleStatesAndTransitions></a><a name="_Toc349215670"></a><a
name="_Toc315528805">Bundle States</a> and Transitions</h1>

<h2><a name="_Toc349215671"></a><a name="_Toc315528806">Introduction</a></h2>

<p class=MsoNormal>As mentioned workspace bundles originates from a plug-in
project in an Eclipse workspace. Deployed (or jar) bundles have different
characteristics compared to workspace bundles. Due to these differences,   the
OSGi settings and commands are tailored for handling dependencies and how they
affect life cycle changes of workspace bundles in a development environment
where bundles are updated and activated/deactivated repeatedly.</p>

<p class=MsoNormal>This section presents an overview of the rules and a summary
of bundles states and transitions and how to interpret them. A list of relevant
terms is presented first. </p>

<h2><a name="_Toc349215672"></a><a name="_Toc315528811">Transitions and Bundle
Operations</a></h2>

<p class=MsoNormal>There is a one-to-one relationship between a transition and
an OSGi command or operation. Every OSGi command used in this section has a
corresponding transition in the state diagram.</p>

<h3><a name="_Toc349215673">Bundle Project</a></h3>

<p class=MsoNormal>A project is an Eclipse plug-in project or an OSGi framework
bundle project. There is a bi-directional one-to-one relationship between a
project and an activated workspace bundle. A workspace bundle is a singleton
and referred to as a bundle project when the relationship between a project and
its bundle is of importance. </p>

<h3><a name="_Toc349215674"></a><a name="_Toc315528813">Workspace and Composite
Commands</a></h3>

<p class=MsoNormal>A workspace command is a simple or a composite OSGi command.
Composite commands consist of a combination of one or more OSGi commands, and
possibly one of the Eclipse build commands.  Activate, Deactivate and Reset are
composite commands.</p>

<h3><a name="_Toc349215675"></a><a name="_Toc315528814">Project CRUD Operations</a></h3>

<p class=MsoNormal>All workspace and project commands that manipulate a project
as a whole or the content in a project associated with a bundle are considered
CRUD operations. The operations are Create (create, open, import project),
Rename (rename, move project), Update (save, save all file(s)) and Delete
(delete, close project). All CRUD operation triggers a workspace bundle command,
except for Update, which must be followed by a build command to trigger a
workspace bundle command. </p>

<h3><a name="_Toc349215676"></a><a name="_Toc315528815">Implicit and Explicit
Commands</a></h3>

<p class=MsoNormal>Bundle commands are divided into explicit (activate,
deactivate, reset, refresh, start, stop) and implicit (install, uninstall,
update, resolve) commands. Explicit commands are executed directly by you as a
developer. Implicit commands are executed automatically when a project CRUD or
an explicit command is issued by the developer.</p>

<h2><a name="_Toc349215677">The Bundle State Diagram</a></h2>

<p class=MsoNormal>The state diagram is copied from the OSGi Service Platform
Release 4, Version 4.3 specification and gives an overview of the possible life
cycle states and transitions that a bundle undergoes. The OSGi specification
gives a detailed explanation of each command (transition) and state. <a
name="_Toc315528817"><img border=0 width=605 height=264
src="Dynamic%20Workspace%20Bundles_files/image001.png" alt=" "></a></p>

<p class=MsoNormal>You can inspect the current state and the last transition
executed on a bundle in the Details View and the Properties Page for a bundle. In
the following, the states and transitions are discussed from the perspective of
workspace bundles and the different commands (transitions) provided by the
InPlace Activator.</p>

<h4>Explicit Composite Commands triggered from the UI</h4>

<p class=MsoListParagraphCxSpFirst style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Activate<br>
</b>A bundle is either in state UNINSTALLED or INSTALLED when deactivated. If
in state UNINSTALLED it is first installed, then resolved and lastly started.
If in s state INSTALLED, the bundle is first updated, then resolved and
started.  A started bundle enters state ACTIVE or STARTING
(&lt;&lt;LAZY&gt;&gt;) according to the declared activation policy in the
manifest file.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Deactivate</b><br>
A bundle is moved to state UNINSTALLED if no other bundles are activated, and
moved to state INSTALLED if there are other activated bundles in the
workspace.  A bundle can be deactivated from any activated state (RESOLVED,
STARTING/&lt;&lt;LAZY&gt;&gt;, STOPPING and ACTIVE). If the bundle is in state
ACTIVE/STARTING it is first stopped, moving the bundle to state RESOLVED. In an
activated workspace the bundle is refreshed (unresolved), moving the bundle to
state INSTALLED. In a deactivated workspace (implies that this is the last
bundle in the workspace to deactivate) the bundle is uninstalled moving the
bundle to state UNINSTALL.</p>

<p class=MsoListParagraphCxSpLast style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Reset<br>
</b>When an activated bundle is reset it is first uninstalled. When in state
UNINSTALLED it is installed, resolved and started if it was in state ACTIVE or
STARTING before the Reset command was issued.</p>

<h4><a name="_Toc315528818"><span style='font-family:"Calibri","sans-serif"'>Explicit
</span></a><span style='font-family:"Calibri","sans-serif"'>OSGi Commands </span>triggered
from the UI</h4>

<p class=MsoListParagraphCxSpFirst style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Stop<br>
</b>When a bundle is in state ACTIVE or STARTING it can be stopped. When
stopped it is moved to state RESOLVED.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Start<br>
</b>When a bundle is in state RESOLVED it can be started.  A started bundle
enters state ACTIVE or STARTING (&lt;&lt;LAZY&gt;&gt;) according to the
declared activation policy in the manifest file.  If the bundle has an eager
activation policy and both requires and use some capabilities from a lazy
activated bundles, the lazy activated bundle is started and moved to state
ACTIVE due to “on demand” class loading. This presumes that the dependency
option for starting bundles includes starting providing bundles.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Refresh<br>
</b>A bundle in state RESOLVED, ACTIVE, STARTING and STOPPING may be refreshed.
Refresh on bundles in state INSTALLED is not put in use. Bundles are stopped,
moving them to state RESOLVED before refreshed. Refresh first unresolves the
bundle before it resolves it again constructing new wires. The resolving
process is an iterative process that searches through the active workspace and
the deployed bundles. If possible a bundle always returns to the same state it
had before being refreshed.<br>
<br>
It is a goal to minimize the number of revisions for a bundle to one. The
refresh operation is available to manually refresh bundles with more than one
revision. </p>

<p class=MsoListParagraphCxSpLast style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Update<br>
</b>If the <a href="../tasks/Setting%20Bundle%20Options.htm#UpdateOnBuild">Update
on Build</a> option is off a bundle is updated manually from the UI. If the
option is on (default) <a href="#UpdateImplicit">update</a> is an implicit
command. </p>

<h4><a name="_Toc315528819"><span style='font-family:"Calibri","sans-serif"'>Implicit
Command</span></a><span style='font-family:"Calibri","sans-serif"'>s triggered
by the InPlace Activator</span></h4>

<p class=MsoListParagraphCxSpFirst style='margin-top:0cm;margin-right:0cm;
margin-bottom:0cm;margin-left:18.0pt;margin-bottom:.0001pt;text-indent:-18.0pt;
line-height:normal;text-autospace:none'><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Install<br>
</b>When a bundle is installed a unique bundle object is created and all
remaining life cycle operations are performed upon this object. Every bundle is
uniquely identified by its location string and is assigned a unique bundle
identifier and a new revision.<br>
<span style='font-size:9.0pt'><br>
</span>Multiple bundles with the same symbolic name and version are not
allowed. Only the first in a set of duplicate bundles are installed.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Uninstall<br>
</b>Bundles are uninstalled when the workspace is deactivated (when there are
no activated bundles in the workspace). The Framework removes any resources
related to the bundle and uninstalls the bundle from the persistent storage of
the Framework. <br>
<br>
The InPlace Activator removes all dependencies when uninstalling the bundle.
When the bundle is uninstalled, this implies that the workspace is deactivated,
and there are no requirements left from the workspace or deployed bundles on
the uninstalled bundle. The bundle is moved to state UNINSTALLED when
uninstalled.</p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;text-indent:-18.0pt'><a
name=UpdateImplicit><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Update</b></a><b><br>
</b>When a project is built, the updated version of the bundle is read from the
input stream and installed, resolved and possibly started.  If the <a
href="../tasks/Setting%20Bundle%20Options.htm#RefreshOnUpdate"><i>Refresh on
Update</i></a> option is switched on the bundle is refreshed instead of
explicit resolved after update. A new revision and wires is also created for
the bundle as part of the update process. If possible the bundle returns to the
state it was in before the update operation. The update command is not run when
the bundle is deactivated (state UNINSTALED or INSTALLED).</p>

<p class=MsoListParagraphCxSpLast style='margin-left:18.0pt;text-indent:-18.0pt'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Resolve<br>
</b>The resolve process, which also is part of the update process,  checks that
all specified dependencies for the bundle is satisfied starting with the
dependency related headers in the manifest (e.g. imports and exports), creates
a wiring between the bundles involved and assigns the revision, created when 
the bundle was installed or updated, to the wired bundle. <br>
<br>
The resolve operation moves the bundle from state INSTALLED to RESOLVED. When
resolved all Java classes that the bundle needs are available. This state
indicates that the bundle is either ready to be started or has stopped. Resolve
is invoked each time a bundle is Activated, Reset, Updated or Refreshed. </p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
